import{_ as U,r as m,c as i,b as u,g as k,w as j,l as h,d as e,t as x,J as M,D as v,G as w,T as E,F as N,i as _,H as A,o as L,x as R,u as I,e as q}from"./index-DJwOSC3o.js";import{N as B}from"./NewsModal-DLD1TrXV.js";const F={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 overflow-y-auto p-4"},G={class:"bg-white p-8 rounded-2xl shadow-2xl w-full max-w-md modal-container mx-4 max-h-full overflow-y-auto"},H={class:"text-3xl font-bold mb-6 text-gray-800 pb-2 border-b-2 border-gray-200"},J={class:"grid grid-cols-1 gap-4"},O={class:"mb-4"},K={class:"mb-4"},P={class:"mb-4"},Q=["src"],W={class:"mb-4"},X={class:"mb-4"},Y={class:"mb-4"},Z={class:"flex justify-end mt-6 gap-4"},ee={type:"submit",class:"bg-brand-primary text-white py-3 px-6 rounded-lg font-semibold hover:bg-brand-accent transition-colors duration-300 shadow-md hover:shadow-lg cursor-pointer"},te={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 overflow-y-auto p-4"},oe={__name:"NewsManagement",emits:["news-updated","open-add-modal"],setup(V,{expose:b,emit:g}){const c=g,d=m(!1),p=m(!1),o=m({id:null,title:"",date:"",image:"",description:"",fullContent:"",author:""}),f=m(null),$=()=>{const l=new Date().toISOString().split("T")[0];o.value={id:null,title:"",date:l,image:"",description:"",fullContent:"",author:""},d.value=!0},C=l=>{o.value={...l},d.value=!0},s=()=>{d.value=!1,o.value={}},r=async()=>{try{await _.post("http://localhost:3000/api/news",o.value),c("news-updated"),s()}catch(l){console.error("Erreur lors de l'ajout de l'actualité :",l)}},n=async()=>{try{await _.put(`http://localhost:3000/api/news/${o.value.id}`,o.value),c("news-updated"),s()}catch(l){console.error("Erreur lors de la mise à jour de l'actualité :",l)}},y=l=>{f.value=l,p.value=!0},S=async()=>{try{await _.delete(`http://localhost:3000/api/news/${f.value}`,{headers:{Authorization:`Bearer ${A.token}`}}),c("news-updated"),D()}catch(l){console.error("Erreur lors de la suppression de l'actualité :",l)}},T=l=>{const t=l.target.files[0];if(t){const a=new FileReader;a.onload=z=>{o.value.image=z.target.result},a.readAsDataURL(t)}},D=()=>{p.value=!1,f.value=null};return b({openAddModal:$,openEditNewsModal:C,deleteNews:y}),(l,t)=>(u(),i(N,null,[k(E,{name:"modal"},{default:j(()=>[d.value?(u(),i("div",F,[e("div",G,[e("h2",H,x(o.value.id?"Modifier l'actualité":"Ajouter une actualité"),1),e("form",{onSubmit:t[5]||(t[5]=M(a=>o.value.id?n():r(),["prevent"]))},[e("div",J,[e("div",O,[t[6]||(t[6]=e("label",{for:"title",class:"block text-gray-700 font-semibold mb-2"},"Titre",-1)),v(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>o.value.title=a),class:"w-full p-3 border-2 border-gray-200 rounded-lg text-black focus:border-blue-500 transition-colors duration-300 shadow-sm focus:shadow-md",required:""},null,512),[[w,o.value.title]])]),e("div",K,[t[7]||(t[7]=e("label",{for:"date",class:"block text-gray-700 font-semibold mb-2"},"Date",-1)),v(e("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=a=>o.value.date=a),class:"w-full p-3 border-2 border-gray-200 rounded-lg text-black focus:border-blue-500 transition-colors duration-300 shadow-sm focus:shadow-md",required:""},null,512),[[w,o.value.date]])]),e("div",P,[t[8]||(t[8]=e("label",{for:"image",class:"block text-gray-700 font-semibold mb-2"},"Image",-1)),e("input",{type:"file",onChange:T,id:"image",accept:"image/*",class:"w-full p-3 border-2 border-gray-200 rounded-lg text-black focus:border-blue-500 transition-colors duration-300 shadow-sm focus:shadow-md"},null,32),o.value.image?(u(),i("img",{key:0,src:o.value.image,alt:"Aperçu de l'image",class:"mt-4 w-full h-auto rounded-lg shadow-md",width:"341",height:"192"},null,8,Q)):h("",!0)]),e("div",W,[t[9]||(t[9]=e("label",{for:"description",class:"block text-gray-700 font-semibold mb-2"},"Description courte",-1)),v(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=a=>o.value.description=a),class:"w-full p-3 border-2 border-gray-200 rounded-lg text-black focus:border-blue-500 transition-colors duration-300 shadow-sm focus:shadow-md",required:""},null,512),[[w,o.value.description]])]),e("div",X,[t[10]||(t[10]=e("label",{for:"fullContent",class:"block text-gray-700 font-semibold mb-2"},"Contenu complet",-1)),v(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=a=>o.value.fullContent=a),id:"fullContent",class:"w-full p-3 border-2 border-gray-200 rounded-lg text-black focus:border-blue-500 transition-colors duration-300 shadow-sm focus:shadow-md",required:""},null,512),[[w,o.value.fullContent]])]),e("div",Y,[t[11]||(t[11]=e("label",{for:"author",class:"block text-gray-700 font-semibold mb-2"},"Auteur",-1)),v(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=a=>o.value.author=a),id:"author",class:"w-full p-2 !h-10 !resize-none border-2 border-gray-200 rounded-lg text-black focus:border-blue-500",required:""},null,512),[[w,o.value.author]])])]),e("div",Z,[e("button",{type:"button",onClick:s,class:"bg-gray-200 text-gray-800 py-3 px-6 rounded-lg font-semibold hover:bg-gray-300 transition-colors duration-300 cursor-pointer shadow-md hover:shadow-lg"}," Annuler "),e("button",ee,x(o.value.id?"Modifier":"Ajouter"),1)])],32)])])):h("",!0)]),_:1}),k(E,{name:"modal"},{default:j(()=>[p.value?(u(),i("div",te,[e("div",{class:"bg-white p-8 rounded-2xl shadow-2xl w-full max-w-sm modal-container mx-4 max-h-full overflow-y-auto"},[t[12]||(t[12]=e("h2",{class:"text-2xl font-bold mb-4 text-gray-800"}," Confirmer la suppression ",-1)),t[13]||(t[13]=e("p",{class:"text-gray-600 mb-6"}," Êtes-vous sûr de vouloir supprimer cette actualité ? Cette action est irréversible. ",-1)),e("div",{class:"flex justify-end gap-4"},[e("button",{onClick:D,class:"bg-gray-200 text-gray-800 py-2 px-4 rounded-lg font-semibold hover:bg-gray-300 cursor-pointer"}," Annuler "),e("button",{onClick:S,class:"bg-red-600 text-white py-2 px-4 rounded-lg font-semibold hover:bg-red-700 cursor-pointer"}," Supprimer ")])])])):h("",!0)]),_:1})],64))}},se=U(oe,[["__scopeId","data-v-07fd727b"]]),le={class:"bg-gray-100 py-16 md:py-24"},ae={class:"container mx-auto px-4 text-center"},re={class:"mt-12 mb-8"},ne={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"},de=["onClick"],ie=["srcset"],ue=["src","alt"],ce={class:"p-6 text-left"},me={class:"text-sm text-gray-500 mb-2"},pe={class:"text-xl font-semibold text-gray-800 mb-3"},be={class:"text-gray-600 text-base"},ge={key:0,class:"mt-4 flex justify-end space-x-2"},fe=["onClick"],ve=["onClick"],we={__name:"ActualitesList",setup(V){const b=m(!1),g=m(null),c=m(null),d=m([]),p=async()=>{try{const s=await _.get("http://localhost:3000/api/news");d.value=s.data,console.log("Actualités récupérées du backend :",d.value)}catch(s){console.error("Erreur lors de la récupération des actualités :",s)}},o=()=>{p()};L(()=>{p()}),R(d,s=>{},{deep:!0});const f=s=>{g.value=s,b.value=!0},$=()=>{b.value=!1,g.value=null},C=s=>{const r={year:"numeric",month:"long",day:"numeric"};return new Date(s).toLocaleDateString("fr-FR",r)};return(s,r)=>(u(),i(N,null,[e("div",le,[e("div",ae,[r[2]||(r[2]=e("h1",{class:"text-5xl font-extrabold mb-4 text-brand-gold text-shadow-sm"},"Toutes les Actualités",-1)),r[3]||(r[3]=e("p",{class:"text-xl text-gray-700 mb-12"}," Retrouvez ici toutes les dernières nouvelles et événements du club. ",-1)),e("div",re,[I(A).isAdmin?(u(),i("button",{key:0,onClick:r[0]||(r[0]=n=>c.value.openAddModal()),class:"btn btn-primary rounded-md px-8 py-3 text-lg shadow-sm transition transform hover:scale-105 duration-300 focus:outline-none focus:ring-2 focus:ring-[var(--brand-accent)] focus:ring-offset-2 cursor-pointer"}," Ajouter une actualité ")):h("",!0)]),e("div",ne,[(u(!0),i(N,null,q(d.value,n=>(u(),i("div",{key:n.id,class:"bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300 cursor-pointer",onClick:y=>f(n)},[e("picture",null,[e("source",{srcset:s.newsItem.image.replace(/\.(jpg|jpeg|png)$/,".webp"),type:"image/webp"},null,8,ie),e("img",{src:s.newsItem.image,alt:s.newsItem.title,class:"w-full h-48 object-cover",loading:"lazy",width:"341",height:"192"},null,8,ue)]),e("div",ce,[e("p",me,x(C(n.date)),1),e("h3",pe,x(n.title),1),e("p",be,x(n.description),1),r[1]||(r[1]=e("span",{class:"text-brand-accent hover:underline mt-4 inline-block"},"Lire la suite",-1)),I(A).isAdmin?(u(),i("div",ge,[e("button",{onClick:M(y=>c.value.openEditNewsModal(n),["stop"]),class:"bg-blue-500 text-white px-3 py-1 rounded-md text-sm hover:bg-blue-600"},"Modifier",8,fe),e("button",{onClick:M(y=>c.value.deleteNews(n.id),["stop"]),class:"bg-red-500 text-white px-3 py-1 rounded-md text-sm hover:bg-red-600"},"Supprimer",8,ve)])):h("",!0)])],8,de))),128))])])]),k(B,{show:b.value,news:g.value,onClose:$},null,8,["show","news"]),k(se,{ref_key:"newsManagementRef",ref:c,onNewsUpdated:o},null,512)],64))}},ye=U(we,[["__scopeId","data-v-112a6577"]]);export{ye as default};
