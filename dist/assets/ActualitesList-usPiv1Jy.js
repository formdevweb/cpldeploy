import{_ as B,r as p,c as d,b as u,g as $,w as D,l as h,d as e,t as x,I as A,D as w,E as v,T as E,F as j,i as _,G as y,o as S,x as T,u as U,e as R}from"./index-7-Q6U3Kq.js";import{N as q}from"./NewsModal-CF1bBpn1.js";const F={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 overflow-y-auto p-4"},G={class:"bg-white p-8 rounded-2xl shadow-2xl w-full max-w-md modal-container mx-4 max-h-full overflow-y-auto"},O={class:"text-3xl font-bold mb-6 text-gray-800 pb-2 border-b-2 border-gray-200"},H={class:"grid grid-cols-1 gap-4"},J={class:"mb-4"},K={class:"mb-4"},P={class:"mb-4"},Q=["src"],W={class:"mb-4"},X={class:"mb-4"},Y={class:"mb-4"},Z={class:"flex justify-end mt-6 gap-4"},ee={type:"submit",class:"bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition-colors duration-300 shadow-md hover:shadow-lg cursor-pointer"},te={key:0,class:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 overflow-y-auto p-4"},oe={__name:"NewsManagement",emits:["news-updated","open-add-modal"],setup(L,{expose:m,emit:b}){const c=b,i=p(!1),g=p(!1),o=p({id:null,title:"",date:"",image:"",description:"",fullContent:"",author:""}),f=p(null),C=()=>{const l=new Date().toISOString().split("T")[0];o.value={id:null,title:"",date:l,image:"",description:"",fullContent:"",author:""},i.value=!0},M=l=>{o.value={...l},i.value=!0},s=()=>{i.value=!1,o.value={}},n=async()=>{try{await _.post("http://localhost:3000/api/news",o.value,{headers:{Authorization:`Bearer ${y.token}`}}),c("news-updated"),s()}catch(l){console.error("Erreur lors de l'ajout de l'actualité :",l)}},r=async()=>{try{await _.put(`http://localhost:3000/api/news/${o.value.id}`,o.value,{headers:{Authorization:`Bearer ${y.token}`}}),c("news-updated"),s()}catch(l){console.error("Erreur lors de la mise à jour de l'actualité :",l)}},k=l=>{f.value=l,g.value=!0},V=async()=>{try{await _.delete(`http://localhost:3000/api/news/${f.value}`,{headers:{Authorization:`Bearer ${y.token}`}}),c("news-updated"),N()}catch(l){console.error("Erreur lors de la suppression de l'actualité :",l)}},z=l=>{const t=l.target.files[0];if(t){const a=new FileReader;a.onload=I=>{o.value.image=I.target.result},a.readAsDataURL(t)}},N=()=>{g.value=!1,f.value=null};return m({openAddModal:C,openEditNewsModal:M,deleteNews:k}),(l,t)=>(u(),d(j,null,[$(E,{name:"modal"},{default:D(()=>[i.value?(u(),d("div",F,[e("div",G,[e("button",{class:"absolute top-4 right-4 text-gray-600 hover:text-gray-900 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded-full p-1",onClick:s},[...t[6]||(t[6]=[e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]),e("h2",O,x(o.value.id?"Modifier l'actualité":"Ajouter une actualité"),1),e("form",{onSubmit:t[5]||(t[5]=A(a=>o.value.id?r():n(),["prevent"]))},[e("div",H,[e("div",J,[t[7]||(t[7]=e("label",{for:"title",class:"block text-gray-700 font-semibold mb-2"},"Titre",-1)),w(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>o.value.title=a),class:"w-full p-3 border-2 border-gray-300 rounded-lg text-black focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-colors duration-300 shadow-sm focus:shadow-md",required:""},null,512),[[v,o.value.title]])]),e("div",K,[t[8]||(t[8]=e("label",{for:"date",class:"block text-gray-700 font-semibold mb-2"},"Date",-1)),w(e("input",{type:"date","onUpdate:modelValue":t[1]||(t[1]=a=>o.value.date=a),class:"w-full p-3 border-2 border-gray-300 rounded-lg text-black focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-colors duration-300 shadow-sm focus:shadow-md",required:""},null,512),[[v,o.value.date]])]),e("div",P,[t[9]||(t[9]=e("label",{for:"image",class:"block text-gray-700 font-semibold mb-2"},"Image",-1)),e("input",{type:"file",onChange:z,id:"image",accept:"image/*",class:"w-full p-3 border-2 border-gray-300 rounded-lg text-black focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-colors duration-300 shadow-sm focus:shadow-md"},null,32),o.value.image?(u(),d("img",{key:0,src:o.value.image,alt:"Aperçu de l'image",class:"mt-4 w-full h-48 object-cover rounded-lg shadow-md",width:"341",height:"192"},null,8,Q)):h("",!0)]),e("div",W,[t[10]||(t[10]=e("label",{for:"description",class:"block text-gray-700 font-semibold mb-2"},"Description courte",-1)),w(e("textarea",{"onUpdate:modelValue":t[2]||(t[2]=a=>o.value.description=a),class:"w-full p-3 border-2 border-gray-300 rounded-lg text-black focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-colors duration-300 shadow-sm focus:shadow-md",required:""},null,512),[[v,o.value.description]])]),e("div",X,[t[11]||(t[11]=e("label",{for:"fullContent",class:"block text-gray-700 font-semibold mb-2"},"Contenu complet",-1)),w(e("textarea",{"onUpdate:modelValue":t[3]||(t[3]=a=>o.value.fullContent=a),id:"fullContent",class:"w-full p-3 border-2 border-gray-300 rounded-lg text-black focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-colors duration-300 shadow-sm focus:shadow-md",required:""},null,512),[[v,o.value.fullContent]])]),e("div",Y,[t[12]||(t[12]=e("label",{for:"author",class:"block text-gray-700 font-semibold mb-2"},"Auteur",-1)),w(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=a=>o.value.author=a),id:"author",class:"w-full p-3 border-2 border-gray-300 rounded-lg text-black focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-colors duration-300 shadow-sm focus:shadow-md",required:""},null,512),[[v,o.value.author]])])]),e("div",Z,[e("button",{type:"button",onClick:s,class:"bg-gray-200 text-gray-800 py-3 px-6 rounded-lg font-semibold hover:bg-gray-300 transition-colors duration-300 cursor-pointer shadow-md hover:shadow-lg"}," Annuler "),e("button",ee,x(o.value.id?"Modifier":"Ajouter"),1)])],32)])])):h("",!0)]),_:1}),$(E,{name:"modal"},{default:D(()=>[g.value?(u(),d("div",te,[e("div",{class:"bg-white p-8 rounded-2xl shadow-2xl w-full max-w-sm modal-container mx-4 max-h-full overflow-y-auto relative"},[e("button",{class:"absolute top-4 right-4 text-gray-600 hover:text-gray-900 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 rounded-full p-1",onClick:N},[...t[13]||(t[13]=[e("svg",{class:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]),t[14]||(t[14]=e("h2",{class:"text-2xl font-bold mb-4 text-gray-800"}," Confirmer la suppression ",-1)),t[15]||(t[15]=e("p",{class:"text-gray-600 mb-6"}," Êtes-vous sûr de vouloir supprimer cette actualité ? Cette action est irréversible. ",-1)),e("div",{class:"flex justify-end gap-4"},[e("button",{onClick:N,class:"bg-gray-200 text-gray-800 py-2 px-4 rounded-lg font-semibold hover:bg-gray-300 transition-colors duration-300 cursor-pointer shadow-md hover:shadow-lg"}," Annuler "),e("button",{onClick:V,class:"bg-red-600 text-white py-2 px-4 rounded-lg font-semibold hover:bg-red-700 transition-colors duration-300 shadow-md hover:shadow-lg"}," Supprimer ")])])])):h("",!0)]),_:1})],64))}},se=B(oe,[["__scopeId","data-v-1675383f"]]),le={class:"bg-gray-100 py-16 md:py-24"},re={class:"container mx-auto px-4 text-center"},ae={class:"mt-12 mb-8"},ne={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"},ie=["onClick"],de=["srcset"],ue=["src","alt"],ce={class:"p-6 text-left"},pe={class:"text-sm text-gray-500 mb-2"},ge={class:"text-xl font-semibold text-gray-800 mb-3"},me={class:"text-gray-600 text-base"},be={key:0,class:"mt-4 flex justify-end space-x-2"},fe=["onClick"],we=["onClick"],ve={__name:"ActualitesList",setup(L){const m=p(!1),b=p(null),c=p(null),i=p([]),g=async()=>{try{const s=await _.get("http://localhost:3000/api/news");i.value=s.data,console.log("Actualités récupérées du backend :",i.value)}catch(s){console.error("Erreur lors de la récupération des actualités :",s)}},o=()=>{g()};S(()=>{g()}),T(i,s=>{},{deep:!0});const f=s=>{b.value=s,m.value=!0},C=()=>{m.value=!1,b.value=null},M=s=>{const n={year:"numeric",month:"long",day:"numeric"};return new Date(s).toLocaleDateString("fr-FR",n)};return(s,n)=>(u(),d(j,null,[e("div",le,[e("div",re,[n[2]||(n[2]=e("h1",{class:"text-5xl font-extrabold mb-4 text-brand-gold text-shadow-sm"},"Toutes les Actualités",-1)),n[3]||(n[3]=e("p",{class:"text-xl text-gray-700 mb-12"}," Retrouvez ici toutes les dernières nouvelles et événements du club. ",-1)),e("div",ae,[U(y).isAdmin?(u(),d("button",{key:0,onClick:n[0]||(n[0]=r=>c.value.openAddModal()),class:"btn btn-primary rounded-md px-8 py-3 text-lg shadow-sm transition transform hover:scale-105 duration-300 focus:outline-none focus:ring-2 focus:ring-[var(--brand-accent)] focus:ring-offset-2 cursor-pointer"}," Ajouter une actualité ")):h("",!0)]),e("div",ne,[(u(!0),d(j,null,R(i.value,r=>(u(),d("div",{key:r.id,class:"bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300 cursor-pointer",onClick:k=>f(r)},[e("picture",null,[e("source",{srcset:r.image.replace(/\.(jpg|jpeg|png)$/,".webp"),type:"image/webp"},null,8,de),e("img",{src:r.image,alt:r.title,class:"w-full h-48 object-cover",loading:"lazy",width:"341",height:"192"},null,8,ue)]),e("div",ce,[e("p",pe,x(M(r.date)),1),e("h3",ge,x(r.title),1),e("p",me,x(r.description),1),n[1]||(n[1]=e("span",{class:"text-brand-accent hover:underline mt-4 inline-block"},"Lire la suite",-1)),U(y).isAdmin?(u(),d("div",be,[e("button",{onClick:A(k=>c.value.openEditNewsModal(r),["stop"]),class:"bg-blue-500 text-white px-3 py-1 rounded-md text-sm hover:bg-blue-600"},"Modifier",8,fe),e("button",{onClick:A(k=>c.value.deleteNews(r.id),["stop"]),class:"bg-red-500 text-white px-3 py-1 rounded-md text-sm hover:bg-red-600"},"Supprimer",8,we)])):h("",!0)])],8,ie))),128))])])]),$(q,{show:m.value,news:b.value,onClose:C},null,8,["show","news"]),$(se,{ref_key:"newsManagementRef",ref:c,onNewsUpdated:o},null,512)],64))}},ye=B(ve,[["__scopeId","data-v-c0153fc1"]]);export{ye as default};
